});
}

// Event listener saat halaman dimuat
document.addEventListener('DOMContentLoaded', function() {
// Muat data pertama kali
fetchDataFromSheet();
// Mulai auto-update
startAutoUpdate();

// Event listener untuk tombol refresh
document.getElementById('refreshBtn').addEventListener('click', function() {
fetchDataFromSheet();
});

// Event listener untuk pencarian dan filter
document.getElementById('searchInput').addEventListener('input', filterTable);
document.getElementById('statusFilter').addEventListener('change', filterTable);

// Inisialisasi tab Bootstrap
const triggerTabList = [].slice.call(document.querySelectorAll('#dashboardTabs button'));
triggerTabList.forEach(function (triggerEl) {
new bootstrap.Tab(triggerEl);
});
});

// Handle visibilitas halaman untuk mengoptimalkan auto-update
document.addEventListener('visibilitychange', function() {
if (document.hidden) {
// Hentikan auto-update ketika tab tidak aktif
stopAutoUpdate();
} else {
// Lanjutkan auto-update ketika tab aktif kembali
startAutoUpdate();
// Perbarui data
fetchDataFromSheet();
}
});
</script>
</body>
</html>
