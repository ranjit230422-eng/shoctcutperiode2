<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Kesalahan CS Line Togel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4e73df;
            --secondary-color: #6f42c1;
            --accent-color: #e83e8c;
            --light-bg: #f8f9fc;
            --dark-bg: #2e59d9;
            --success-color: #1cc88a;
            --warning-color: #f6c23e;
            --danger-color: #e74a3b;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7ff 0%, #c3cfe2 100%);
            min-height: 100vh;
            font-family: 'Nunito', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-bottom: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 2rem 0;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .card {
            border-radius: 15px;
            border: none;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 2rem 0 rgba(58, 59, 69, 0.2);
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            font-weight: bold;
            padding: 1rem 1.5rem;
            border-bottom: none;
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        .error-count {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }
        
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .table th {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 1rem;
            font-weight: 600;
        }
        
        .table td {
            padding: 1rem;
            vertical-align: middle;
            border-color: #e3e6f0;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(78, 115, 223, 0.05);
        }
        
        .badge-error {
            background-color: var(--accent-color);
            padding: 0.5em 0.8em;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
            flex-direction: column;
        }
        
        .spinner {
            width: 3rem;
            height: 3rem;
            color: var(--primary-color);
        }
        
        .last-updated {
            font-size: 0.9rem;
            color: #6c757d;
            background: #f8f9fc;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            display: inline-block;
        }
        
        .cs-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9rem;
        }
        
        .progress {
            height: 10px;
            margin-top: 5px;
            border-radius: 5px;
            background-color: #eaecf4;
        }
        
        .progress-bar {
            border-radius: 5px;
        }
        
        .search-container {
            margin-bottom: 20px;
        }
        
        .pagination {
            justify-content: center;
            margin-top: 20px;
        }
        
        .alert-info {
            border-left: 5px solid var(--primary-color);
            border-radius: 8px;
            background-color: #f8f9fc;
        }
        
        .stat-card {
            text-align: center;
            padding: 1.5rem;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .stat-label {
            color: #5a5c69;
            font-size: 0.9rem;
        }
        
        .top-error-item {
            transition: background-color 0.2s;
            border-left: none;
            border-right: none;
        }
        
        .top-error-item:first-child {
            border-top: none;
        }
        
        .top-error-item:hover {
            background-color: #f8f9fc;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            transform: translateY(-2px);
        }
        
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .status-good {
            background-color: rgba(28, 200, 138, 0.2);
            color: var(--success-color);
        }
        
        .status-warning {
            background-color: rgba(246, 194, 62, 0.2);
            color: var(--warning-color);
        }
        
        .status-critical {
            background-color: rgba(231, 74, 59, 0.2);
            color: var(--danger-color);
        }
        
        .filter-section {
            background-color: #f8f9fc;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .refresh-animation {
            animation: rotate 1s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @media (max-width: 768px) {
            .card-header {
                padding: 0.75rem 1rem;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            .table td, .table th {
                padding: 0.75rem;
            }
            
            .error-count {
                font-size: 2rem;
            }
        }

        .debug-panel {
            background-color: #f8f9fc;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="header text-center">
        <div class="container">
            <h1 class="display-4"><i class="fas fa-chart-line me-2"></i>Laporan Kesalahan CS Line Togel</h1>
            <p class="lead">Monitoring dan evaluasi performa customer service</p>
        </div>
    </div>

    <div class="container">
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="alert alert-info">
                    <strong><i class="fas fa-info-circle me-2"></i>Info:</strong> Data diambil langsung dari Google Sheets. Pastikan spreadsheet sudah dipublikasikan agar data dapat diakses.
                    <div class="form-check form-switch mt-2">
                        <input class="form-check-input" type="checkbox" id="useSampleData" checked>
                        <label class="form-check-label" for="useSampleData">Gunakan data contoh untuk testing</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-8 mx-auto">
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-info-circle me-2"></i>Informasi Data
                    </div>
                    <div class="card-body">
                        <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
                            <div class="mb-3 mb-md-0 text-center text-md-start">
                                <h5>Sumber Data</h5>
                                <p class="mb-0">Google Sheets - Real Time</p>
                                <small class="text-muted">https://docs.google.com/spreadsheets/d/1WMbp6aWmubH5R0lAtIMMQbKDuzfCmh4qrUCEBxqZK9E</small>
                            </div>
                            <div class="text-center text-md-end">
                                <div class="last-updated mb-2" id="lastUpdated">
                                    <i class="fas fa-clock me-1"></i>Terakhir diperbarui: -
                                </div>
                                <button class="btn btn-primary" id="refreshBtn">
                                    <i class="fas fa-sync-alt me-1"></i>Refresh Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-5">
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-chart-bar me-2"></i>Statistik Kesalahan
                    </div>
                    <div class="card-body">
                        <div class="row text-center mb-4">
                            <div class="col-12">
                                <div class="error-count" id="totalErrors">0</div>
                                <p class="text-muted">Total Kesalahan</p>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="stat-card">
                                    <div class="stat-number" id="totalCS">0</div>
                                    <div class="stat-label">Total CS</div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="stat-card">
                                    <div class="stat-number" id="averageErrors">0</div>
                                    <div class="stat-label">Rata-rata Kesalahan</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>CS dengan kesalahan terbanyak:</span>
                                <strong id="mostErrors">-</strong>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-exclamation-triangle me-2"></i>5 Kesalahan Tertinggi
                    </div>
                    <div class="card-body p-0">
                        <ol id="topErrorsList" class="list-group list-group-numbered list-group-flush">
                            <li class="list-group-item top-error-item d-flex justify-content-between align-items-start">
                                <div class="ms-2 me-auto">
                                    <div class="fw-bold">Memuat data...</div>
                                </div>
                                <span class="badge-error">0</span>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
            
            <div class="col-md-7">
                <div class="card">
                    <div class="card-header text-center d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-list me-2"></i>Daftar Lengkap Kesalahan CS</span>
                        <span class="badge bg-danger" id="csCount">0 CS</span>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <div class="row">
                                <div class="col-md-8 mb-2 mb-md-0">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                        <input type="text" id="searchInput" class="form-control" placeholder="Cari nama CS atau ID...">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <select class="form-select" id="sortSelect">
                                        <option value="name">Urutkan berdasarkan Nama</option>
                                        <option value="errors-desc">Kesalahan (Tinggi ke Rendah)</option>
                                        <option value="errors-asc">Kesalahan (Rendah ke Tinggi)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-hover" id="csTable">
                                <thead>
                                    <tr>
                                        <th>CS</th>
                                        <th>ID</th>
                                        <th>Jumlah Kesalahan</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="csTableBody">
                                    <tr>
                                        <td colspan="4" class="text-center">
                                            <div class="loading">
                                                <div class="spinner-border spinner" role="status"></div>
                                                <p class="mt-2">Memuat data...</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <nav aria-label="Page navigation">
                            <ul class="pagination" id="pagination">
                                <!-- Pagination akan di-generate oleh JavaScript -->
                            </ul>
                        </nav>

                        <div class="debug-panel mt-3 d-none" id="debugPanel">
                            <h6>Debug Information:</h6>
                            <div id="debugContent"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Konfigurasi
        const SHEET_ID = '1WMbp6aWmubH5R0lAtIMMQbKDuzfCmh4qrUCEBxqZK9E';
        const SHEET_NAME = 'Sheet1';
        const ROWS_PER_PAGE = 10;
        
        // Variabel global untuk data
        let csData = [];
        let currentPage = 1;
        let filteredData = [];
        let useSampleData = true; // Default menggunakan data contoh
        
        // Data contoh untuk testing berdasarkan daftar yang diberikan
        const sampleData = generateSampleData();
        
        function generateSampleData() {
            const names = [
                "WIDJAYA C6202945 / E7721607",
                "DAVID C6169860 / E6864058",
                "FALLEN HARDINANSAH TAJU C6931386",
                "CHARLIE C7377694/E9519110",
                "HARIANTO X2242791",
                "RINAL ABDILLAH NASUTION C8409170",
                "ERI HARIANTO C8493406",
                "MAHENDRAN C6813799",
                "ANDHIKA DWI PUTRA C8543470",
                "TOMMY HASIM C6735321",
                "EGI SETIAWAN C8410298",
                "RANJIT X1068990",
                "WILLY PERAYUDA E0089312",
                "ANGGA AZMAL HARAHAP C9260456",
                "LALU MUHAMMAD ADNAN ZAKARIA C7565548 / E7776988",
                "ANDI E4487475",
                "ALFINO MUKTI C8493352",
                "AKAS FARMA C8490102",
                "ARI ROMANDUS FERNANDO C8386112",
                "PARIS AMRULLOH E0237731",
                "SAMSUL MAARIF C7008737",
                "SUHAN RAZ C5862955",
                "RAHMADI SORMIN E0685561"
            ];
            
            const errorTypes = [
                "Salah input data", 
                "Respon lambat", 
                "Salah informasi", 
                "Tidak ramah",
                "Tidak mematuhi SOP",
                "Kesalahan teknis",
                "Tidak follow up"
            ];
            
            const data = [];
            const startDate = new Date(2023, 5, 1); // 1 Juni 2023
            const endDate = new Date(); // Hari ini
            
            // Generate kesalahan acak untuk setiap CS
            names.forEach(name => {
                // Pisahkan nama dan ID
                const parts = name.split(' ');
                const csName = parts.slice(0, -1).join(' ');
                const csId = parts[parts.length - 1];
                
                // Jumlah kesalahan acak antara 0-15
                const errorCount = Math.floor(Math.random() * 16);
                
                for (let i = 0; i < errorCount; i++) {
                    // Tanggal acak antara startDate dan endDate
                    const randomDate = new Date(startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime()));
                    const formattedDate = randomDate.toISOString().split('T')[0];
                    
                    // Jenis kesalahan acak
                    const randomErrorType = errorTypes[Math.floor(Math.random() * errorTypes.length)];
                    
                    data.push({
                        'Tanggal': formattedDate,
                        'Nama CS': csName,
                        'ID CS': csId,
                        'Jenis Kesalahan': randomErrorType,
                        'Keterangan': `Contoh keterangan untuk ${randomErrorType.toLowerCase()}`
                    });
                }
            });
            
            return data;
        }

        // Fungsi untuk mengambil data dari Google Sheets
        async function fetchDataFromSheet() {
            try {
                // Tampilkan loading state
                document.getElementById('csTableBody').innerHTML = `
                    <tr>
                        <td colspan="4" class="text-center">
                            <div class="loading">
                                <div class="spinner-border spinner" role="status"></div>
                                <p class="mt-2">Memuat data...</p>
                            </div>
                        </td>
                    </tr>
                `;

                // Reset debug panel
                document.getElementById('debugPanel').classList.add('d-none');
                
                let data = [];
                
                if (useSampleData) {
                    // Gunakan data contoh
                    data = sampleData;
                    document.getElementById('debugContent').innerHTML = '<div class="text-success">Menggunakan data contoh</div>';
                    document.getElementById('debugPanel').classList.remove('d-none');
                } else {
                    // URL untuk mengambil data dari Google Sheets sebagai CSV
                    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;
                    
                    // Fetch data
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const csvData = await response.text();
                    
                    // Parse CSV ke JSON
                    data = parseCSV(csvData);
                    
                    // Tampilkan data mentah untuk debugging
                    document.getElementById('debugContent').innerHTML = 
                        `<strong>Data mentah (${data.length} baris):</strong><br>` +
                        `<pre>${JSON.stringify(data.slice(0, 3), null, 2)}</pre>` +
                        (data.length > 3 ? `<div>... dan ${data.length - 3} baris lainnya</div>` : '');
                    document.getElementById('debugPanel').classList.remove('d-none');
                }
                
                // Proses data
                processData(data);
                
                // Update UI
                updateUI();
                
                // Update waktu terakhir
                document.getElementById('lastUpdated').innerHTML = 
                    `<i class="fas fa-clock me-1"></i>Terakhir diperbarui: ${new Date().toLocaleTimeString('id-ID')}`;
                
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('csTableBody').innerHTML = `
                    <tr>
                        <td colspan="4" class="text-center text-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>Gagal memuat data: ${error.message}
                        </td>
                    </tr>
                `;
                
                // Tampilkan error di debug panel
                document.getElementById('debugContent').innerHTML = 
                    `<div class="text-danger">Error: ${error.message}</div>`;
                document.getElementById('debugPanel').classList.remove('d-none');
            }
        }
        
        // Fungsi untuk parsing CSV
        function parseCSV(csv) {
            const lines = csv.split('\n').filter(line => line.trim() !== '');
            if (lines.length === 0) return [];
            
            const result = [];
            
            // Ambil header (baris pertama)
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            
            // Proses setiap baris data
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                
                const obj = {};
                const currentline = lines[i].split(',').map(c => c.trim().replace(/^"|"$/g, ''));
                
                for (let j = 0; j < headers.length; j++) {
                    // Handle kasus dimana jumlah kolom tidak sesuai
                    if (j < currentline.length) {
                        obj[headers[j]] = currentline[j] || '';
                    } else {
                        obj[headers[j]] = '';
                    }
                }
                
                result.push(obj);
            }
            
            return result;
        }
        
        // Fungsi untuk memproses data
        function processData(data) {
            // Reset data
            csData = [];
            
            // Jika tidak ada data, keluar
            if (data.length === 0) {
                return;
            }
            
            // Debug: Tampilkan keys dari data pertama untuk memeriksa struktur
            const firstItem = data[0];
            const keys = Object.keys(firstItem);
            document.getElementById('debugContent').innerHTML += 
                `<br><strong>Kolom yang terdeteksi:</strong> ${keys.join(', ')}`;
            
            // Cari kolom yang berisi nama CS
            let nameKey = 'Nama CS';
            if (!firstItem.hasOwnProperty('Nama CS')) {
                // Coba cari kolom yang mungkin berisi nama
                const possibleNameKeys = ['Nama', 'CS', 'Customer Service', 'Nama Customer Service', 'Name', 'CS Name'];
                for (const key of possibleNameKeys) {
                    if (firstItem.hasOwnProperty(key)) {
                        nameKey = key;
                        break;
                    }
                }
            }
            
            // Cari kolom yang berisi ID CS
            let idKey = 'ID CS';
            if (!firstItem.hasOwnProperty('ID CS')) {
                // Coba cari kolom yang mungkin berisi ID
                const possibleIdKeys = ['ID', 'CS ID', 'ID Customer Service', 'CS Code', 'Code'];
                for (const key of possibleIdKeys) {
                    if (firstItem.hasOwnProperty(key)) {
                        idKey = key;
                        break;
                    }
                }
            }
            
            document.getElementById('debugContent').innerHTML += 
                `<br><strong>Kolom nama:</strong> ${nameKey}, <strong>Kolom ID:</strong> ${idKey}`;
            
            // Hitung jumlah kesalahan per CS
            const errorCounts = {};
            
            data.forEach(row => {
                const csName = row[nameKey] || 'Tidak Diketahui';
                const csId = row[idKey] || 'Tidak Diketahui';
                
                if (!errorCounts[csName]) {
                    errorCounts[csName] = {
                        id: csId,
                        count: 0,
                        name: csName
                    };
                }
                
                errorCounts[csName].count++;
            });
            
            // Konversi ke array
            csData = Object.values(errorCounts);
            
            // Simpan data yang sudah difilter
            filteredData = [...csData];
            
            document.getElementById('debugContent').innerHTML += 
                `<br><strong>Data CS yang diproses:</strong> ${csData.length} CS ditemukan`;
        }
        
        // Fungsi untuk memperbarui UI dengan data terbaru
        function updateUI() {
            // Update statistik
            document.getElementById('totalErrors').textContent = csData.reduce((sum, cs) => sum + cs.count, 0);
            document.getElementById('totalCS').textContent = csData.length;
            document.getElementById('averageErrors').textContent = csData.length ? 
                Math.round(csData.reduce((sum, cs) => sum + cs.count, 0) / csData.length) : 0;
            
            // CS dengan kesalahan terbanyak
            if (csData.length) {
                const mostErrors = csData.reduce((max, cs) => (cs.count > max.count ? cs : max), csData[0]);
                document.getElementById('mostErrors').textContent = `${mostErrors.name} (${mostErrors.count})`;
            } else {
                document.getElementById('mostErrors').textContent = '-';
            }
            
            // Update 5 kesalahan tertinggi
            updateTopErrorsList();
            
            // Update tabel
            updateTable();
            
            // Update jumlah CS
            document.getElementById('csCount').textContent = `${csData.length} CS`;
        }
        
        // Fungsi untuk memperbarui daftar 5 kesalahan tertinggi
        function updateTopErrorsList() {
            const topErrorsList = document.getElementById('topErrorsList');
            
            if (!csData.length) {
                topErrorsList.innerHTML = `
                    <li class="list-group-item top-error-item d-flex justify-content-between align-items-start">
                        <div class="ms-2 me-auto">
                            <div class="fw-bold">Tidak ada data</div>
                        </div>
                    </li>
                `;
                return;
            }
            
            // Urutkan berdasarkan kesalahan terbanyak
            const sortedData = [...csData].sort((a, b) => b.count - a.count).slice(0, 5);
            
            topErrorsList.innerHTML = '';
            
            sortedData.forEach((cs, index) => {
                const li = document.createElement('li');
                li.className = 'list-group-item top-error-item d-flex justify-content-between align-items-start';
                li.innerHTML = `
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">${cs.name}</div>
                        <small class="text-muted">ID: ${cs.id}</small>
                    </div>
                    <span class="badge-error">${cs.count}</span>
                `;
                topErrorsList.appendChild(li);
            });
        }
        
        // Fungsi untuk memperbarui tabel
        function updateTable() {
            const tableBody = document.getElementById('csTableBody');
            
            if (!filteredData.length) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="text-center">
                            Tidak ada data yang sesuai dengan pencarian
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Hitung pagination
            const totalPages = Math.ceil(filteredData.length / ROWS_PER_PAGE);
            if (currentPage > totalPages) currentPage = 1;
            
            // Data untuk halaman saat ini
            const startIndex = (currentPage - 1) * ROWS_PER_PAGE;
            const endIndex = Math.min(startIndex + ROWS_PER_PAGE, filteredData.length);
            const currentData = filteredData.slice(startIndex, endIndex);
            
            // Isi tabel
            tableBody.innerHTML = '';
            
            currentData.forEach(cs => {
                const tr = document.createElement('tr');
                
                // Tentukan status berdasarkan jumlah kesalahan
                let statusClass = 'status-good';
                let statusText = 'Baik';
                
                if (cs.count >= 10) {
                    statusClass = 'status-critical';
                    statusText = 'Kritis';
                } else if (cs.count >= 5) {
                    statusClass = 'status-warning';
                    statusText = 'Perhatian';
                }
                
                tr.innerHTML = `
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="cs-avatar">${cs.name.charAt(0)}</div>
                            <div>${cs.name}</div>
                        </div>
                    </td>
                    <td>${cs.id}</td>
                    <td>
                        <div class="d-flex align-items-center">
                            <span class="me-2">${cs.count}</span>
                            <div class="progress" style="width: 100px">
                                <div class="progress-bar bg-danger" role="progressbar" style="width: ${Math.min(cs.count * 10, 100)}%"></div>
                            </div>
                        </div>
                    </td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                `;
                
                tableBody.appendChild(tr);
            });
            
            // Update pagination
            updatePagination(totalPages);
        }
        
        // Fungsi untuk memperbarui pagination
        function updatePagination(totalPages) {
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Tombol Previous
            paginationHTML += `
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" data-page="${currentPage - 1}">Previous</a>
                </li>
            `;
            
            // Halaman
            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `
                    <li class="page-item ${currentPage === i ? 'active' : ''}">
                        <a class="page-link" href="#" data-page="${i}">${i}</a>
                    </li>
                `;
            }
            
            // Tombol Next
            paginationHTML += `
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" data-page="${currentPage + 1}">Next</a>
                </li>
            `;
            
            pagination.innerHTML = paginationHTML;
            
            // Tambahkan event listener untuk pagination
            pagination.querySelectorAll('.page-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    currentPage = parseInt(link.getAttribute('data-page'));
                    updateTable();
                });
            });
        }
        
        // Fungsi untuk mencari data
        function searchData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const sortBy = document.getElementById('sortSelect').value;
            
            // Filter data
            filteredData = csData.filter(cs => 
                cs.name.toLowerCase().includes(searchTerm) || 
                (cs.id && cs.id.toLowerCase().includes(searchTerm))
            );
            
            // Urutkan data
            switch(sortBy) {
                case 'name':
                    filteredData.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'errors-desc':
                    filteredData.sort((a, b) => b.count - a.count);
                    break;
                case 'errors-asc':
                    filteredData.sort((a, b) => a.count - b.count);
                    break;
            }
            
            // Reset ke halaman pertama
            currentPage = 1;
            
            // Perbarui tabel
            updateTable();
        }
        
        // Event listener saat halaman dimuat
        document.addEventListener('DOMContentLoaded', ()
