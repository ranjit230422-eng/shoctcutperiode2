border: 1px solid rgba(106, 17, 203, 0.2);
background: rgba(255, 255, 255, 0.8);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
transition: all 0.3s ease;
}
.search-box input:focus {
outline: none;
border-color: #6a11cb;
box-shadow: 0 5px 15px rgba(106, 17, 203, 0.2);
}
.search-box i {
position: absolute;
right: 20px;
top: 50%;
transform: translateY(-50%);
color: #6a11cb;
}
.filter-select {
min-width: 180px;
padding: 12px 20px;
border-radius: 50px;
border: 1px solid rgba(106, 17, 203, 0.2);
background: rgba(255, 255, 255, 0.8);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
appearance: none;
background-image: url("https://images.unsplash.com/photo-1505142468610-359e7d316be0?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80");
background-repeat: no-repeat;
background-position: right 1rem center;
background-size: 1em;
}
.filter-select:focus {
outline: none;
border-color: #6a11cb;
box-shadow: 0 5px 15px rgba(106, 17, 203, 0.2);
}

/* Chart container */
.chart-container {
position: relative;
height: 300px;
margin-bottom: 30px;
background: rgba(255, 255, 255, 0.7);
border-radius: 20px;
padding: 20px;
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
}

/* Tabs for additional views */
.nav-tabs {
border-bottom: 2px solid rgba(106, 17, 203, 0.2);
margin-bottom: 20px;
}
.nav-tabs .nav-link {
border: none;
color: var(--light-text);
font-weight: 500;
padding: 12px 25px;
border-radius: 10px 10px 0 0;
transition: all 0.3s ease;
}
.nav-tabs .nav-link.active {
color: #6a11cb;
background: rgba(106, 17, 203, 0.1);
border-bottom: 3px solid #6a11cb;
}
.nav-tabs .nav-link:hover {
border: none;
color: #6a11cb;
background: rgba(106, 17, 203, 0.05);
}

/* History panel */
.history-panel {
max-height: 300px;
overflow-y: auto;
padding-right: 10px;
}
.history-item {
background: rgba(255, 255, 255, 0.8);
border-radius: 15px;
padding: 15px;
margin-bottom: 15px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
border-left: 4px solid #6a11cb;
transition: all 0.3s ease;
}
.history-item:hover {
transform: translateX(5px);
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}
.history-time {
font-size: 0.8rem;
color: var(--light-text);
margin-bottom: 5px;
}
.history-content {
font-weight: 500;
}

/* Scrollbar styling */
::-webkit-scrollbar {
width: 8px;
}
::-webkit-scrollbar-track {
background: rgba(106, 17, 203, 0.1);
border-radius: 10px;
}
::-webkit-scrollbar-thumb {
background: rgba(106, 17, 203, 0.3);
border-radius: 10px;
}
::-webkit-scrollbar-thumb:hover {
background: rgba(106, 17, 203, 0.5);
}
</style>
</head>
<body>
<div class="floating-shape shape-1"></div>
<div class="floating-shape shape-2"></div>
<div class="floating-shape shape-3"></div>
<div class="floating-shape shape-4"></div>
<div class="decoration-circle" style="top: 15%; left: 10%;"></div>
<div class="decoration-circle" style="top: 25%; right: 12%; width: 30px; height: 30px;"></div>
<div class="decoration-circle" style="bottom: 20%; left: 15%; width: 25px; height: 25px;"></div>

<div class="floating-notification success" id="updateNotification">
<i class="fas fa-check-circle notification-icon notification-success"></i>
<div>
<strong>Data Diperbarui!</strong>
<div>Data terbaru telah berhasil diambil</div>
</div>
</div>
<div class="auto-update-indicator" id="autoUpdateIndicator">
<i class="fas fa-sync-alt"></i> Auto-update aktif
</div>
<div class="container">
<div class="header text-center mb-5">
<h1 class="display-4 fw-bold"><i class="fas fa-chart-line me-2"></i>Laporan Kesalahan CS Line Togel</h1>
<p class="lead">Monitoring dan evaluasi performa customer service</p>

<!-- CS LINE di kanan atas -->
<div class="cs-line-top-center">
<strong>CS LINE</strong>
<div>CHARLIE</div>
<div>ANDI</div>
<div>RINAL ABDILLAH NASUTION</div>
</div>

<div class="d-flex justify-content-center align-items-center mt-4">
<div class="refresh-btn me-3" id="refreshBtn">
<i class="fas fa-sync-alt"></i>
</div>
<div class="last-updated" id="lastUpdated">
<i class="fas fa-clock me-1"></i>Terakhir diperbarui: -
</div>
</div>
</div>

<ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
<li class="nav-item" role="presentation">
<button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true">
<i class="fas fa-chart-pie me-2"></i>Ringkasan
</button>
</li>
<li class="nav-item" role="presentation">
<button class="nav-link" id="details-tab" data-bs-toggle="tab" data-bs-target="#details" type="button" role="tab" aria-controls="details" aria-selected="false">
<i class="fas fa-table me-2"></i>Detail Data
</button>
</li>
<li class="nav-item" role="presentation">
<button class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#history" type="button" role="tab" aria-controls="history" aria-selected="false">
<i class="fas fa-history me-2"></i>Riwayat
</button>
</li>
</ul>

<div class="tab-content" id="dashboardTabContent">
<div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
<div class="stats-grid">
<div class="stats-card">
<div class="stats-number" id="totalErrors">0</div>
<div class="stats-label">Total Kesalahan</div>
</div>
<div class="stats-card">
<div class="stats-number" id="totalCS">0</div>
<div class="stats-label">Jumlah CS</div>
</div>
<div class="stats-card">
<div class="stats-number" id="averageErrors">0.0</div>
<div class="stats-label">Rata-rata Kesalahan</div>
</div>
<div class="stats-card">
<div class="stats-number" id="criticalCount">0</div>
<div class="stats-label">CS Status Danger</div>
</div>
</div>

<div class="row mb-4">
<div class="col-md-12">
<div class="card">
<div class="card-header text-center">
<i class="fas fa-chart-bar me-2"></i>Distribusi Kesalahan CS
</div>
<div class="card-body">
<div class="chart-container">
<canvas id="errorDistributionChart"></canvas>
</div>
</div>
</div>
</div>
</div>

<div class="row mb-4">
<div class="col-md-12">
<div class="card">
<div class="card-header text-center">
<i class="fas fa-trophy me-2"></i>Top 3 Performa Terbaik
</div>
<div class="card-body">
<div class="row" id="top3Container">
<!-- Data akan diisi oleh JavaScript -->
</div>
</div>
</div>
</div>
</div>
</div>

<div class="tab-pane fade" id="details" role="tabpanel" aria-labelledby="details-tab">
<div class="row">
<div class="col-md-12">
<div class="card">
<div class="card-header text-center d-flex justify-content-between align-items-center">
<span><i class="fas fa-list me-2"></i>Daftar Lengkap Kesalahan CS</span>
<span class="badge bg-danger" id="csCount">0 CS</span>
</div>
<div class="card-body">
<div class="search-container">
<div class="search-box">
<input type="text" id="searchInput" placeholder="Cari nama CS...">
<i class="fas fa-search"></i>
</div>
<select class="filter-select" id="statusFilter">
<option value="all">Semua Status</option>
<option value="good">Good</option>
<option value="warning">Warning</option>
<option value="danger">Danger</option>
</select>
</div>
<div class="table-responsive">
<table class="table table-hover" id="csTable">
<thead>
<tr>
<th>Peringkat</th>
<th>Nama CS</th>
<th>Total Kesalahan</th>
<th>Status</th>
</tr>
</thead>
<tbody id="csTableBody">
<!-- Data akan diisi oleh JavaScript -->
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="tab-pane fade" id="history" role="tabpanel" aria-labelledby="history-tab">
<div class="row">
<div class="col-md-12">
<div class="card">
<div class="card-header text-center">
<i class="fas fa-history me-2"></i>Riwayat Perubahan Data
</div>
<div class="card-body">
<div class="history-panel" id="historyPanel">
<!-- Riwayat akan diisi oleh JavaScript -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Modal untuk Detail CS -->
<div class="modal fade" id="csDetailModal" tabindex="-1" aria-labelledby="csDetailModalLabel" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="csDetailModalLabel">Detail Kesalahan CS</h5>
<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
<div class="text-center mb-4">
<div class="cs-avatar mx-auto mb-2" id="modalAvatar">R</div>
<h4 id="modalName">Nama CS</h4>
<div class="stats-number mt-2" id="modalErrors">0</div>
<div class="stats-label">Total Kesalahan</div>
</div>

<div class="detail-item">
<span class="detail-label">Peringkat:</span>
<span class="detail-value" id="modalRank">-</span>
</div>

<div class="detail-item">
<span class="detail-label">Status:</span>
<span class="detail-value" id="modalStatus">-</span>
</div>

<div class="detail-item">
<span class="detail-label">Performa:</span>
<span class="detail-value" id="modalPerformance">-</span>
</div>

<div class="motivation-message" id="modalMessage">
<!-- Pesan motivasi akan diisi oleh JavaScript -->
</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
</div>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Data dari Google Sheets
let csData = [];
let previousData = [];
let autoUpdateInterval;
let csDetailModal = new bootstrap.Modal(document.getElementById('csDetailModal'));
let errorDistributionChart = null;
let historyData = [];

// Fungsi untuk mengatur status berdasarkan jumlah kesalahan
function getStatus(errors) {
if (errors === 0) return { text: "Excellent", class: "status-good" };
if (errors <= 5) return { text: "Good", class: "status-good" };
if (errors <= 20) return { text: "Warning", class: "status-warning" };
return { text: "Danger", class: "status-danger" };
}

// Fungsi untuk mendapatkan pesan motivasi berdasarkan jumlah kesalahan
function getMotivationMessage(errors, name) {
if (errors <= 25) {
return `<div class="message-good">
<i class="fas fa-check-circle me-2"></i>Pertahankan, ${name.split(' ')[0]}! Performa Anda sudah baik.
</div>`;
} else {
return `<div class="message-bad">
<i class="fas fa-exclamation-circle me-2"></i>Coba lagi periode depan, ${name.split(' ')[0]}! Perbaiki kinerja Anda.
</div>`;
}
}

// Fungsi untuk mendapatkan performa berdasarkan peringkat
function getPerformance(rank, totalCS) {
const percentage = (rank / totalCS) * 100;
if (percentage <= 10) return "Top 10%";
if (percentage <= 25) return "Top 25%";
if (percentage <= 50) return "Rata-rata";
if (percentage <= 75) return "Di bawah rata-rata";
return "Perlu peningkatan";
}

// Fungsi untuk menampilkan detail CS
function showCSDetail(cs, rank) {
const status = getStatus(cs.errors);
const performance = getPerformance(rank, csData.length);

document.getElementById('modalAvatar').textContent = cs.name.charAt(0);
document.getElementById('modalName').textContent = cs.name;
document.getElementById('modalErrors').textContent = cs.errors;
document.getElementById('modalRank').textContent = `#${rank}`;
document.getElementById('modalStatus').innerHTML = `<span class="status-badge ${status.class}">${status.text}</span>`;
document.getElementById('modalPerformance').textContent = performance;
document.getElementById('modalMessage').innerHTML = getMotivationMessage(cs.errors, cs.name);

csDetailModal.show();
}

// Fungsi untuk menampilkan notifikasi
function showNotification(type, message) {
const notification = document.getElementById('updateNotification');
const icon = notification.querySelector('.notification-icon');
const strong = notification.querySelector('strong');
const div = notification.querySelector('div');
notification.className = `floating-notification ${type}`;
icon.className = `fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'} notification-icon notification-${type}`;
strong.textContent = type === 'success' ? 'Data Diperbarui!' : 'Error!';
div.innerHTML = message;
notification.classList.add('show');
setTimeout(() => {
notification.classList.remove('show');
}, 3000);
}

// Fungsi untuk menambahkan riwayat
function addHistory(message) {
const now = new Date();
const timeString = now.toLocaleTimeString('id-ID');
const dateString = now.toLocaleDateString('id-ID', {
weekday: 'long',
year: 'numeric',
month: 'long',
day: 'numeric'
});

historyData.unshift({
time: `${dateString} ${timeString}`,
message: message
});

// Batasi riwayat hingga 10 item
if (historyData.length > 10) {
historyData.pop();
}

renderHistory();
}

// Fungsi untuk merender riwayat
function renderHistory() {
const historyPanel = document.getElementById('historyPanel');
historyPanel.innerHTML = historyData.map(item => `
<div class="history-item">
<div class="history-time">${item.time}</div>
<div class="history-content">${item.message}</div>
</div>
`).join('');
}

// Fungsi untuk memuat data dari Google Sheets
async function fetchDataFromSheet() {
try {
// URL Google Sheets yang sudah dipublikasikan
const sheetUrl = 'https://docs.google.com/spreadsheets/d/1WMbp6aWmubH5R0lAtIMMQbKDuzfCmh4qrUCEBxqZK9E/gviz/tq?tqx=out:csv&sheet=part1';
const response = await fetch(sheetUrl);
if (!response.ok) {
throw new Error(`HTTP error! status: ${response.status}`);
}
const csvData = await response.text();

// Parsing CSV dengan fungsi yang lebih andal
const parsedData = parseCSV(csvData);

const headers = parsedData.headers;
const rows = parsedData.data;

// Cari indeks kolom yang benar
const nameIndex = headers.findIndex(header =>
header.toLowerCase().includes('nama') || header.toLowerCase().includes('cs')
);
const errorIndex = headers.findIndex(header =>
header.toLowerCase().includes('total') || header.toLowerCase().includes('kesalahan')
);

// Jika tidak menemukan kolom yang sesuai, gunakan kolom pertama dan kedua
const finalNameIndex = nameIndex !== -1 ? nameIndex : 0;
const finalErrorIndex = errorIndex !== -1 ? errorIndex : 1;

const data = [];
for (let i = 0; i < rows.length; i++) {
const row = rows[i];
if (row.length <= Math.max(finalNameIndex, finalErrorIndex)) continue;

const name = row[finalNameIndex] || 'Tidak Diketahui';
const errors = parseInt(row[finalErrorIndex]) || 0;
data.push({ name, errors });
}

// Simpan data sebelumnya untuk perbandingan
previousData = [...csData];

// Filter CS tertentu yang ingin dihilangkan
csData = data.filter(cs =>
!cs.name.includes("RINAL ABDILLAH NASUTION") &&
!cs.name.includes("ANDI") &&
!cs.name.includes("CHARLIE")
);

renderData();
showNotification('success', 'Data terbaru telah berhasil diambil');
addHistory('Data diperbarui dari Google Sheets');
} catch (error) {
console.error('Error fetching data:', error);
showNotification('error', 'Gagal memuat data: ' + error.message);
addHistory('Gagal memuat data: ' + error.message);

// Jika tidak ada data sebelumnya, tampilkan pesan error
if (csData.length === 0) {
document.getElementById('totalErrors').textContent = 'Error';
document.getElementById('totalCS').textContent = 'Error';
document.getElementById('averageErrors').textContent = 'Error';
document.getElementById('criticalCount').textContent = 'Error';
document.getElementById('csCount').textContent = 'Error';
}
}
}

// Fungsi untuk merender data
function renderData() {
// Urutkan data berdasarkan jumlah kesalahan (dari terkecil ke terbesar)
const sortedData = [...csData].sort((a, b) => a.errors - b.errors);

// Hitung statistik
const totalErrors = sortedData.reduce((sum, cs) => sum + cs.errors, 0);
const totalCS = sortedData.length;
const averageErrors = totalCS > 0 ? (totalErrors / totalCS).toFixed(1) : 0;
const criticalCount = sortedData.filter(cs => cs.errors > 25).length;

// Update statistik
document.getElementById('totalErrors').textContent = totalErrors;
document.getElementById('totalCS').textContent = totalCS;
document.getElementById('averageErrors').textContent = averageErrors;
document.getElementById('criticalCount').textContent = criticalCount;
document.getElementById('csCount').textContent = `${totalCS} CS`;

// Update waktu terakhir
document.getElementById('lastUpdated').innerHTML = `<i class="fas fa-clock me-1"></i>Terakhir diperbarui: ${new Date().toLocaleTimeString('id-ID')}`;

// Render top 3
const top3 = sortedData.slice(0, 3);
const top3Html = top3.map((cs, index) => {
const status = getStatus(cs.errors);
const shortName = cs.name.split(' ')[0];
return `
<div class="col-md-4 mb-3">
<div class="winner-card winner-card-${index+1} text-center p-3">
<div class="winner-badge">${index === 0 ? 'ðŸ¥‡' : index === 1 ? 'ðŸ¥ˆ' : 'ðŸ¥‰'}</div>
<h4>Juara ${index+1}</h4>
<div class="cs-avatar mx-auto mb-2">${shortName.charAt(0)}</div>
<h5>${shortName}</h5>
<p class="mb-1 text-truncate">${cs.name.split(' ').slice(1).join(' ')}</p>
<div class="stats-number ${cs.errors === 0 ? 'text-success' : 'text-primary'}">${cs.errors}</div>
<div class="stats-label">Kesalahan</div>
<span class="status-badge ${status.class}">${status.text}</span>
</div>
</div>
`;
}).join('');
document.getElementById('top3Container').innerHTML = top3Html;

// Render tabel
const tableHtml = sortedData.map((cs, index) => {
const status = getStatus(cs.errors);
let rankBadge = `<div class="rank-badge">${index+1}</div>`;
if (index === 0) rankBadge = `<div class="rank-badge rank-1">1</div>`;
else if (index === 1) rankBadge = `<div class="rank-badge rank-2">2</div>`;
else if (index === 2) rankBadge = `<div class="rank-badge rank-3">3</div>`;
return `
<tr>
<td>${rankBadge}</td>
<td>
<div class="d-flex align-items-center">
<div class="cs-avatar">${cs.name.charAt(0)}</div>
<div class="cs-name-clickable" onclick="showCSDetail(${JSON.stringify(cs).replace(/"/g, '&quot;')}, ${index+1})">${cs.name}</div>
</div>
</td>
<td>${cs.errors}</td>
<td><span class="status-badge ${status.class}">${status.text}</span></td>
</tr>
`;
}).join('');
document.getElementById('csTableBody').innerHTML = tableHtml;

// Render chart distribusi kesalahan
renderErrorDistributionChart(sortedData);
}

// Fungsi untuk merender chart distribusi kesalahan
function renderErrorDistributionChart(data) {
const ctx = document.getElementById('errorDistributionChart').getContext('2d');

// Hancurkan chart sebelumnya jika ada
if (errorDistributionChart) {
errorDistributionChart.destroy();
}

// Siapkan data untuk chart
const labels = data.map(cs => {
const names = cs.name.split(' ');
return names.length > 1 ? `${names[0]} ${names[1].charAt(0)}.` : names[0];
});
const errors = data.map(cs => cs.errors);
const backgroundColors = data.map(cs => {
const status = getStatus(cs.errors);
if (status.class === 'status-good') return 'rgba(29, 209, 161, 0.7)';
if (status.class === 'status-warning') return 'rgba(254, 202, 87, 0.7)';
return 'rgba(255, 107, 107, 0.7)';
});

// Buat chart baru
errorDistributionChart = new Chart(ctx, {
type: 'bar',
data: {
labels: labels,
datasets: [{
label: 'Jumlah Kesalahan',
data: errors,
backgroundColor: backgroundColors,
borderColor: 'rgba(106, 17, 203, 0.8)',
borderWidth: 1
}]
},
options: {
responsive: true,
maintainAspectRatio: false,
scales: {
y: {
beginAtZero: true,
title: {
display: true,
text: 'Jumlah Kesalahan'
}
},
x: {
ticks: {
maxRotation: 45,
minRotation: 45
}
}
},
plugins: {
legend: {
display: false
},
tooltip: {
callbacks: {
label: function(context) {
return `Kesalahan: ${context.raw}`;
},
afterLabel: function(context) {
const cs = data[context.dataIndex];
const status = getStatus(cs.errors);
return `Status: ${status.text}`;
}
}
}
}
}
});
}

// Fungsi untuk memulai auto-update
function startAutoUpdate() {
// Hapus interval sebelumnya jika ada
if (autoUpdateInterval) {
clearInterval(autoUpdateInterval);
}
// Set interval untuk auto-update setiap 2 menit
autoUpdateInterval = setInterval(fetchDataFromSheet, 120000);
// Tampilkan indikator auto-update
document.getElementById('autoUpdateIndicator').style.display = 'flex';
}

// Fungsi untuk menghentikan auto-update
function stopAutoUpdate() {
if (autoUpdateInterval) {
clearInterval(autoUpdateInterval);
autoUpdateInterval = null;
}
// Sembunyikan indikator auto-update
document.getElementById('autoUpdateIndicator').style.display = 'none';
}

// Fungsi untuk parsing CSV yang lebih andal
function parseCSV(csv) {
const rows = csv.split(/\r?\n/).filter(row => row.trim() !== '');
if (rows.length === 0) return { headers: [], data: [] };

const headers = rows[0].split(',').map(header => header.trim().replace(/^"|"$/g, ''));
const data = [];

for (let i = 1; i < rows.length; i++) {
const row = rows[i];
const values = [];
let current = '';
let inQuote = false;

for (let j = 0; j < row.length; j++) {
if (row[j] === '"' && (j === 0 || row[j-1] !== '\\')) {
inQuote = !inQuote;
} else if (row[j] === ',' && !inQuote) {
values.push(current);
current = '';
} else {
current += row[j];
}
}
values.push(current);

// Hapus tanda kutip di awal dan akhir jika ada
const cleanValues = values.map(value => value.trim().replace(/^"|"$/g, ''));
data.push(cleanValues);
}

return { headers, data };
}

// Fungsi untuk memfilter tabel
function filterTable() {
const searchText = document.getElementById('searchInput').value.toLowerCase();
const statusFilter = document.getElementById('statusFilter').value;
const rows = document.querySelectorAll('#csTableBody tr');

rows.forEach(row => {
const name = row.querySelector('.cs-name-clickable').textContent.toLowerCase();
const status = row.querySelector('.status-badge').classList.contains('status-good') ? 'good' :
row.querySelector('.status-badge').classList.contains('status-warning') ? 'warning' : 'danger';

const nameMatch = name.includes(searchText);
const statusMatch = statusFilter === 'all' || status === statusFilter;

row.style.display = (nameMatch && statusMatch) ? '' : 'none';
});
}

// Event listener saat halaman dimuat
document.addEventListener('DOMContentLoaded', function() {
// Muat data pertama kali
fetchDataFromSheet();
// Mulai auto-update
startAutoUpdate();

// Event listener untuk tombol refresh
document.getElementById('refreshBtn').addEventListener('click', function() {
fetchDataFromSheet();
});

// Event listener untuk pencarian dan filter
document.getElementById('searchInput').addEventListener('input', filterTable);
document.getElementById('statusFilter').addEventListener('change', filterTable);

// Inisialisasi tab Bootstrap
const triggerTabList = [].slice.call(document.querySelectorAll('#dashboardTabs button'));
triggerTabList.forEach(function (triggerEl) {
new bootstrap.Tab(triggerEl);
});
});

// Handle visibilitas halaman untuk mengoptimalkan auto-update
document.addEventListener('visibilitychange', function() {
if (document.hidden) {
// Hentikan auto-update ketika tab tidak aktif
stopAutoUpdate();
} else {
// Lanjutkan auto-update ketika tab aktif kembali
startAutoUpdate();
// Perbarui data
fetchDataFromSheet();
}
});
</script>
</body>
</html>
